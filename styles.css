:root{
      --bg:#0b0f14;
      --text:#e6edf6;
      --muted:#a7b4c6;

      --cold: rgba(99,179,255,.78);
      --hot: rgba(255,209,102,.78);
      --drain: rgba(110,231,183,.78);

      --shadow: 0 10px 30px rgba(0,0,0,.45);
      --r:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial;
      color:var(--text);
      background:
        radial-gradient(1100px 700px at 20% 10%, rgba(99,179,255,.10), transparent 55%),
        radial-gradient(1000px 700px at 85% 15%, rgba(110,231,183,.08), transparent 60%),
        linear-gradient(180deg, var(--bg), #070a0f 70%, #05070b);
    }
    .wrap{max-width:1200px;margin:22px auto;padding:0 16px 26px}
    header{display:flex;gap:14px;align-items:flex-start;justify-content:space-between;margin-bottom:12px}
    h1{margin:0;font-size:20px;letter-spacing:-.2px;font-weight:780}
    .sub{margin:6px 0 0;color:var(--muted);font-size:13px;line-height:1.45;max-width:900px}
    .badge{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 12px;border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      color:var(--muted);font-size:12px;white-space:nowrap
    }
    .dot{width:8px;height:8px;border-radius:999px;background:var(--cold);box-shadow:0 0 0 4px rgba(99,179,255,.12)}
    .grid{display:grid;grid-template-columns:1.25fr .75fr;gap:14px}
    @media (max-width: 980px){.grid{grid-template-columns:1fr}}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .hd{
      padding:14px 16px;
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      border-bottom:1px solid rgba(255,255,255,.06);
      background: linear-gradient(180deg, rgba(15,23,36,.85), rgba(15,23,36,.35));
    }
    .hd .h{display:flex;flex-direction:column;gap:2px}
    .hd .h strong{font-size:14px;letter-spacing:-.2px}
    .hd .h span{font-size:12px;color:var(--muted)}
    .bd{padding:14px 16px}

    .controls{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;align-items:center}
    button{
      appearance:none;cursor:pointer;user-select:none;
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.03));
      color:var(--text);
      padding:10px 12px;border-radius:12px;font-size:12.5px;
      transition:transform .08s ease,border-color .12s ease,opacity .12s ease;
    }
    button:hover{border-color: rgba(99,179,255,.35)}
    button:active{transform: translateY(1px)}
    button.primary{
      border-color: rgba(99,179,255,.35);
      background: linear-gradient(180deg, rgba(99,179,255,.22), rgba(99,179,255,.08));
    }
    button.ghost{background:transparent}
    button:disabled{opacity:.45;cursor:not-allowed}

    .pill{
      padding:6px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color:var(--muted);
      font-size:12px;font-variant-numeric:tabular-nums;
    }
    .stepper{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
    .progress{
      height:8px;border-radius:999px;overflow:hidden;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.08);
      flex:1;min-width:180px;
    }
    .bar{height:100%;width:0%;background: rgba(99,179,255,.65);transition:width .25s ease}

    .bigTitle{margin:0;font-size:16px;letter-spacing:-.2px}
    .oneLine{margin:8px 0 0;color:var(--text);font-size:13.5px;line-height:1.55}
    .whatNow{
      margin-top:10px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.18);
      color:var(--muted);
      font-size:12.5px;
      line-height:1.5;
    }
    .whatNow b{color:var(--text)}
    .miniList{margin:10px 0 0;padding:0;list-style:none;display:grid;gap:8px}
    .miniItem{
      padding:10px 12px;border-radius:14px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.14);
      display:flex;gap:10px;align-items:flex-start;
      cursor:pointer;
      transition:border-color .12s ease, transform .08s ease, background-color .12s ease;
    }
    .miniItem:hover{border-color: rgba(99,179,255,.25)}
    .miniItem:active{transform: translateY(1px)}
    .miniNum{
      width:26px;height:26px;border-radius:10px;
      display:flex;align-items:center;justify-content:center;
      background: rgba(99,179,255,.14);
      border:1px solid rgba(99,179,255,.25);
      color: rgba(230,237,246,.95);
      font-size:12px;flex:0 0 auto;
      font-variant-numeric:tabular-nums;
    }
    .miniTxt{display:flex;flex-direction:column;gap:4px}
    .miniTxt strong{font-size:12.5px;color:rgba(230,237,246,.92)}
    .miniTxt span{font-size:12px;color:var(--muted);line-height:1.45}

    /* 현재 STEP 고정 하이라이트(약하게, 깜빡임 없음) */
    .miniItem.active{
      border-color: rgba(99,179,255,.22);
      background: rgba(99,179,255,.06);
      box-shadow: 0 0 0 1px rgba(99,179,255,.10) inset;
    }
    .miniItem.active .miniNum{
      border-color: rgba(99,179,255,.22);
      background: rgba(99,179,255,.16);
    }
    .miniItem.active .miniTxt strong{color: rgba(230,237,246,.96);}
    .miniItem.active .miniTxt span{color: rgba(167,180,198,.95);}

    .legend{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px;color:var(--muted);font-size:12px}
    .lg{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.08);background: rgba(0,0,0,.16)}
    .sw{width:12px;height:12px;border-radius:4px;background: var(--cold)}
    .sw.hot{background: var(--hot)}
    .sw.drain{background: var(--drain)}
    .sw.idle{background: rgba(255,255,255,.35)}

    svg{width:100%;height:auto;display:block}
    .frame{fill: rgba(0,0,0,.16);stroke: rgba(255,255,255,.08);stroke-width:1.2}
    .label{fill: rgba(230,237,246,.93);font-size:12px;letter-spacing:-.2px}
    .sublabel{fill: rgba(167,180,198,.9);font-size:11px}
    .box{fill: rgba(16,24,38,.78);stroke: rgba(255,255,255,.12);stroke-width:1.2}
    .box2{fill: rgba(16,24,38,.55);stroke: rgba(255,255,255,.10);stroke-width:1.1}
    .pipe{fill:none;stroke: rgba(255,255,255,.18);stroke-width:6.5;stroke-linecap:round;stroke-linejoin:round}
    .pipe.thin{stroke-width:5.4}
    .pipe.cold{stroke: var(--cold)}
    .pipe.hot{stroke: var(--hot)}
    .pipe.drain{stroke: var(--drain)}
    .pipe.dash{stroke-dasharray: 10 12; animation: moveDash 1.25s linear infinite}
    @keyframes moveDash{from{stroke-dashoffset:0}to{stroke-dashoffset:-120}}
    .node{fill: rgba(255,255,255,.16);stroke: rgba(255,255,255,.18);stroke-width:1}
    .valve{fill: rgba(0,0,0,.22);stroke: rgba(255,255,255,.18);stroke-width:1}
    .gateLine{stroke: rgba(255,255,255,.18);stroke-width:1.2}
    .gateOn{stroke: rgba(110,231,183,.85)}
    .flowDot{opacity:0}
    .flowing .flowDot{opacity:1}
    .flowDot.cold{filter: drop-shadow(0 0 6px rgba(99,179,255,.35))}
    .flowDot.hot{filter: drop-shadow(0 0 6px rgba(255,209,102,.35))}
    .flowDot.drain{filter: drop-shadow(0 0 6px rgba(110,231,183,.35))}

    /* HX internal coil paths */
    .coil{
      fill:none;
      stroke: rgba(255,255,255,.18);
      stroke-width:5.2;
      stroke-linecap:round;
      stroke-linejoin:round;
      opacity:.30;
    }
    .coilFlow{
      stroke: rgba(255,209,102,.88);
      opacity:.98;
      stroke-dasharray: 10 14;
      animation: coilDash 0.85s linear infinite;
      filter: drop-shadow(0 0 10px rgba(255,209,102,.28));
    }
    @keyframes coilDash{from{stroke-dashoffset:0}to{stroke-dashoffset:-140}}

    /* sump water level */
    .water{fill: rgba(110,231,183,.20);stroke: rgba(110,231,183,.25);stroke-width:1;opacity:0;}
    .waterOn{opacity:1}
    .waterSurface{stroke: rgba(110,231,183,.65);stroke-width:2;opacity:0;}
    .waterSurfaceOn{opacity:.95;filter: drop-shadow(0 0 8px rgba(110,231,183,.25));}

    /* Tooltip */
    .tooltip{
      position:fixed;z-index:40;
      min-width:240px;max-width:360px;
      padding:12px 12px;border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(10,14,20,.92);
      box-shadow: 0 18px 40px rgba(0,0,0,.55);
      display:none;
      backdrop-filter: blur(10px);
    }
    .tooltip h3{margin:0 0 6px;font-size:13px;letter-spacing:-.2px}
    .tooltip p{margin:0;color:var(--muted);font-size:12.5px;line-height:1.5}
    .tooltip .meta{margin-top:8px;display:flex;gap:8px;flex-wrap:wrap;color:rgba(167,180,198,.85);font-size:11.5px}
    .tooltip .chip{padding:4px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.10);background: rgba(255,255,255,.05)}

    /* Step emphasis effects */
    @keyframes glowCold {0%,100%{filter:none}50%{filter:drop-shadow(0 0 12px rgba(99,179,255,.42))}}
    @keyframes glowHot  {0%,100%{filter:none}50%{filter:drop-shadow(0 0 12px rgba(255,209,102,.42))}}
    @keyframes glowDrain{0%,100%{filter:none}50%{filter:drop-shadow(0 0 12px rgba(110,231,183,.42))}}
    @keyframes heatPulse {0%,100%{filter:drop-shadow(0 0 6px rgba(255,209,102,.18))}50%{filter:drop-shadow(0 0 16px rgba(255,209,102,.45))}}
    @keyframes fillWobble {0%,100%{opacity:.55}50%{opacity:.88}}

    .glow-cold{ animation: glowCold 1.15s ease-in-out infinite; }
    .glow-hot{  animation: glowHot  1.15s ease-in-out infinite; }
    .glow-drain{animation: glowDrain 1.15s ease-in-out infinite; }

    .tank-cold-active{ fill: rgba(99,179,255,.12) !important; animation: fillWobble 1.1s ease-in-out infinite; }
    .tank-hot-active { fill: rgba(255,209,102,.12) !important; animation: fillWobble 1.1s ease-in-out infinite; }

    .hx-heat{ animation: heatPulse 1.0s ease-in-out infinite; }
    .pump-run{ animation: heatPulse 1.05s ease-in-out infinite; }

    .overview-lite .frame{
      stroke: rgba(99,179,255,.18);
      filter: drop-shadow(0 0 14px rgba(99,179,255,.10));
    }

    /* STEP Dimming */
    .dimOn svg .dimTarget{
      opacity:.22;
      transition: opacity .18s ease, filter .18s ease;
    }
    .dimOn svg .dimTarget.focus{
      opacity:1;
      filter: drop-shadow(0 0 10px rgba(230,237,246,.06));
    }
    .dimOn svg text.dimTarget{opacity:.18;}
    .dimOn svg text.dimTarget.focus{opacity:.92;filter:none;}

    /* ===== v6.2 Mobile: 레이아웃/컨트롤/툴팁/터치 ===== */
    .hotspot{cursor:pointer}
    @media (max-width: 820px){
      .wrap{margin:14px auto;padding:0 12px 18px}
      header{flex-direction:column;align-items:flex-start}
      .badge{align-self:flex-start}

      .grid{grid-template-columns:1fr}
      .hd{flex-direction:column;align-items:stretch;gap:10px}

      /* 컨트롤을 하단에 sticky로: 한 손 조작 */
      .controls{
        position: sticky;
        bottom: 10px;
        z-index: 20;
        padding:10px;
        border-radius: 16px;
        background: rgba(10,14,20,.75);
        border:1px solid rgba(255,255,255,.10);
        backdrop-filter: blur(10px);
        box-shadow: 0 14px 40px rgba(0,0,0,.55);
        justify-content:space-between;
      }
      .stepper{width:100%;min-width:0}
      .stepper .progress{min-width:120px}
      button{flex:1;min-width:0;padding:12px 10px}
      button.ghost{flex:0.9}

      /* 작은 점/밸브 터치 체감 개선(시각적 약간 확대) */
      svg .node, svg .valve{
        transform-box: fill-box;
        transform-origin:center;
        transform: scale(1.25);
      }

      /* 툴팁을 bottom-sheet로 */
      .tooltip{
        left: 12px !important;
        right: 12px !important;
        top: auto !important;
        bottom: 12px !important;
        width: auto !important;
        max-width: none !important;
        display:none;
      }
    }
